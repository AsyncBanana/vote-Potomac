---
import Button from "../components/Button.svelte";
import Textarea from "../components/Textarea.astro";
import BaseLayout from "../layouts/BaseLayout.astro";
import { verifyOAuthJWT } from "../modules/auth";
const authData = Astro.cookies.get("authData")?.value;
const session = authData && (await verifyOAuthJWT(authData));
if (!session) {
	return Astro.locals.login("/submit");
}
---

<BaseLayout class="w-main">
	<h1 class="font-bold text-5xl">Submit suggestion</h1>
	<form
		class="form-control flex"
		id="suggestionSubmit"
		action="/suggestion"
		method="post"
	>
		<label class="label" for="title">Title</label>
		<input
			type="text"
			class="input input-bordered"
			id="title"
			name="title"
			required
			minlength={import.meta.env.MIN_TITLE_LENGTH}
			maxlength={import.meta.env.MAX_TITLE_LENGTH}
		/>
		<Textarea
			markdown={true}
			resize={true}
			rows={10}
			required
			name="description"
			minlength={import.meta.env.MIN_DESCRIPTION_LENGTH}
			maxlength={import.meta.env.MAX_DESCRIPTION_LENGTH}
		>
			Description
		</Textarea>
		<Button class="mt-3">Suggest</Button>
	</form>
</BaseLayout>
